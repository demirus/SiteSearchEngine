<h1 align="center">SiteSearchEngine</h1>

## Описание
SiteSearchEngine — это приложение, которое позволяет индексировать страницы и быстро искать их.
## Технологический стэк
- **Java 11**
- **Spring boot**
- **Spring data**
- **Apache Maven**
- **Postgresql**
- **Jsoup**
- **[russianmorphology](https://github.com/akuznetsov/russianmorphology)**
## Установка
### База данных
Для функционирования приложения необходимо установить PostgreSQL и создать пустую базу с именем search_engine.
### Сборка приложения
Приложение собирается с помощью Apache Maven
Для корректной сборки проекта, необходимо добавить в настройки Maven (файл settings.xml) следующий блок:
```
<servers>
    <server>
      <id>skillbox-gitlab</id>
      <configuration>
        <httpHeaders>
          <property>
            <name>Private-Token</name>
            <value>wtb5axJDFX9Vm_W1Lexg</value>
          </property>
        </httpHeaders>
      </configuration>
    </server>
  </servers>
```
После внесения данных изменений проект должен собраться без ошибок командой:
```
mvn clean install
```
### Запуск и конфигурирование приложения
Полученный в предыдущем шаге jar-файл, необходимо разместить в папке, из которой будет работать приложение.
#### Конфигурирование приложения
Для конфигурирования приложения нужно в папке с jar-файлом создать файл application.yaml
##### Описание настроек приложения
| Наименование настройки  | Значение по умолчанию |  Описание |
| ------------- | ------------- | --------|
| server/port  | 8080  | Настройка для указания на каком порту будет запущен веб-сервер |
| spring/datasource/url  | jdbc:postgresql://localhost:5432/search_engine  | Указывается адрес базы данных и её наименование |
| spring/datasource/username  | Не имеет  | Логин пользователя БД |
| spring/datasource/password  | Не имеет  | Пароль пользователя БД |
| parser/userAgent  | Chrome/4.0.249.0 Safari/532.5  | userAgent, который будет использоваться в HTTP-запросах, при парсинге сейтов |
| parser/referrer  | SiteSearchEngine  | referrer, который будет использоваться в HTTP-запросах, при парсинге сейтов |
| parser/intervalBetweenRequests  | 3000  | Интервал между запросами к сайту в милисекундах |
| parser/autoStart  | false  | Настройка позволяющаяя задать будет ли приложения при каждом запуске автоматически начинать индексацию/переиндексацию всех сайтов, которые находятся в базе данных приложения |
| parser/configSites  | Не имеет  | Настройка позволяющаяя задать начальный список сайтов, в виде списка объектов для кажждого из который нужно задать name (Наименование сайта) и url (Адрес сайта), более конкретный пример указания данного параметра будет представлен ниже|
| search/maxLemmaFrequency  | 0 | Настройка позволяющаяя задать частоту лемм при которой они будут отсееваться из поисковой выдачи, при значении 0, будет использоваться формула (частота леммы >= общее количество страниц сайта - 50)|
| web-interface/path  | admin | Настройка определяющая путь до web-интерфейса приложения|

**Пример минимальной настройки конфигурационного файла**
```
spring:
  datasource:    
    username: postgres
    password: 12345  
parser:  
  configSites:
    -
      name: someName
      url: someUrl
    -
      name: someName
      url: someUrl
```
#### Запуск приложения
После создания конфигурационного файла приложение готово к запуску. Запуск можно осуществить с помощью терминала/коммандной строки выполнив команду 
```
java -jar test.jar
```
### Описание API приложения

| Путь  | HTTP метод | Параметры | Описание |
| ------------- | ------------- | --------| -------|
| api/startIndexing  | GET  | Не имеет | Запуск индексации или переиндексации всех сайтов |
| api/stopIndexing  | GET  | Не имеет | Остановка индексации или переиндексации всех сайтов |
| api/stopSiteIndexing  | GET  | String url | Остановка индексации или переиндексации отдельного сайта |
| api/startSiteIndexing  | GET  | String url | Запуск индексации или переиндексации отдельного сайта |
| api/indexSite  | POST  | String name, String url | Запуск индексации нового конкретного сайта или переиндексация существующего |
| api/deleteSite  | DELETE  | String url | Удаление сайта и всех связаных с ним объектов из приложения |
| api/search  | GET  | String query, Integer offset(не обязательный), Integer limit(не обязательный), String site | Удаление сайта и всех связаных с ним объектов из приложения |
| api/statistics  | GET  | Не имеет | Метод возвращает статистику и другую служебную информацию о состоянии поисковых индексов и самого движка. |
